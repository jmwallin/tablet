setwd('~/Projects/tablet_norming/eye_tracking/R/')
# clear all previous variables
rm(list=ls())
#get lab version of useful R functions
source('~/Projects/Other/Ranalysis/useful_dplyr.R')
#load libraries for data manipulation and graphing
library(directlabels)
library(xtable)
#splits ages into half-years
split.ages <-function(x) {floor(x)}
#Constants for window-of-interest analysis
TEST_START <- 1
TEST_END <- 3
TRAIN_START <- 0
TRAIN_END <- 2
#Use color-brewer colors for graphing
man_cols <- c("#e41a1c","#377eb8","#4daf4a",
"#984ea3","#ff7f00","#a65628",
"#f781bf","#999999")
###############################################################################
################################ LOADING DATA #################################
###############################################################################
#read looking data
raw.data <- read.csv("../MATLAB/tab_comp_r.csv",header=TRUE)
data <- raw.data %>%
#pre-process data values to be more English-readable
mutate(
trial.type = factor(trial.type,
labels=c("Familiar", "Novel")),
aoi = as.character(factor(aoi, labels=c("Left", "Right","NA"))),
time.step = time.step/60 - 2,
gender = factor(gender,labels=c("Male","Female")),
age.grp = split.ages(age)) %>%
filter(age >= 1)
trial.codes <- read.csv("trial.codes.csv",header=TRUE,
stringsAsFactor = FALSE)
#summarize across individual trials
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
mutate(aoi = if(aoi == "NA") "NA"
else if(as.character(aoi) == as.character(target)) "Target"
else "Competitor")
head(test.data)
test.data$aoi
unique(test.data$aoi)
#summarize across individual trials
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END)
head(test.data)
test.data$aoi
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor")
head(test.data)
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor")
head(test.data)
test.data$aoi
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = as.factor(if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor"),
levels = c("Target", "Competitor", "NA")%>%
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = as.factor(if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor"),
levels = c("Target", "Competitor", "NA"))%>%
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor"))%>%
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor") %>%
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
head(test.data)
hist(test.data$prop)
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor")
head(test.data)
test.data$aoi
head(test.data)
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor") %>%
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
head(test.data)
test.data$prop
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor")
test.data$aoi == "Competitor"
sum(test.data$aoi == "Competitor")
sum(test.data$aoi == "Target")
warnings()
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor")
head(test.data)
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,age,age.grp,gender,subj,word.type,trial.num)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor") %>%
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
head(test.data)
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor")
head(test.data)
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num,time.step)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor") %>%
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
head(test.data)
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num,time.step)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor")
head(test.data)
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num,word.type,
time.step)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor") %>%
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
head(test.data)
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num,word.type,
time.step)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor") %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num,word.type)
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
test.data <- left_join(data,trial.codes) %>%
filter(time.step >=TEST_START,
time.step <= TEST_END) %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num,word.type,
time.step)%>%
mutate(aoi = if(aoi == "NA") "NA"
else if(aoi== target) "Target"
else "Competitor") %>%
group_by(list.num,word.type,age,age.grp,gender,subj,trial.num,word.type) %>%
summarise(
prop = sum(aoi=="Target")/(sum(aoi=="Target")+sum(aoi=="Competitor")))
head(test.data)
test.data$propr
test.data$prop
hist(test.data$prop)
head(test.data)
#summarize by subject
test.data.subj <- test.data %>%
summarise(kept = sum(!is.na(prop))/length(prop),
prop=na.mean(prop)) %>%
filter(kept >= .5) %>% # Throw out participants who don't have enough data
select(-kept) %>%
ungroup()
head(test.data.subj)
#summarize by trial.type
test.data.trial <- test.data.subj %>%
group_by(age.grp,word.type,add=FALSE) %>%
summarise_each(funs(na.mean,ci.low,ci.high),prop)
head(test.data.trial)
preflook.data <- test.data.trial
#Demographic data
demo.data <- test.data.subj %>%
group_by(age.grp,trial.type) %>%
summarise(n = n(),
num.girls = sum(gender=="Female")) %>%
filter(trial.type=="Familiar") %>%
select(-trial.type)
#Demographic data
demo.data <- test.data.subj %>%
group_by(age.grp,word.type) %>%
summarise(n = n(),
num.girls = sum(gender=="Female")) %>%
filter(word.type=="Familiar-Familiar") %>%
select(-word.type)
demo.data
